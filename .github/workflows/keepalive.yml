name: Keep Render Services Alive

on:
  schedule:
    - cron: "*/5 * * * *" # Runs every 5 minutes
  workflow_dispatch:

jobs:
  ping:
    runs-on: ubuntu-latest

    steps:
      - name: Ping Render services (optimized)
        run: |
          echo "Pinging Render services..."

          SERVICES=(
            "https://real-time-chat-app-k142.onrender.com/api/health"
            "https://private-cloud-q87z.onrender.com/health"
            "https://focusfy-ulgr.onrender.com/health"
          )

          for URL in "${SERVICES[@]}"; do
            echo "Pinging: $URL"

            # Optimized:
            # - Retry 1 time only
            # - Wait 5 seconds only
            # - Timeout = 10 seconds max
            curl --retry 1 --retry-delay 5 -m 10 -s "$URL" \
              && echo "✅ Success: $URL" \
              || echo "❌ Failed: $URL (ignored)"
          done

          echo "All services pinged."
